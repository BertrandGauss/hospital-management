<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Layui</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../lib/layui/css/layui.css" tppabs="https://www.layui.site/layui/dist/css/layui.css" media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
</head>

<body>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>新增预约</legend>
</fieldset>
<form class="layui-form" action="">
    <div class="layui-form-item" lay-filter="layerSel">
        <label class="layui-form-label">验证身份证</label>
        <div class="layui-input-block">
            <input type="text" name="identity" lay-verify="identity" placeholder="" autocomplete="off" class="layui-input">
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">选择医生</label>
        <div class="layui-input-inline"  lay-filter="doctorSel">
            <select name="office">
                <option value="">科室</option>
                <option value="内科">内科</option>
                <option value="外科">外科</option>
            </select>
        </div>

        <div class="layui-input-inline"  lay-filter="doctorSel">
            <select name="title">
                <option value="">请选择门诊形式</option>
                <option value="专家门诊">专家门诊</option>
                <option value="普通门诊">普通门诊</option>
            </select>
        </div>

        <div class="layui-inline"  lay-filter="layerSel">
            <label class="layui-form-label">预约日期</label>
            <div class="layui-input-inline">
                <input type="text" name="date" id="date" lay-verify="date" placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
            </div>
        </div>

        <div class="layui-input-inline">
            <select name="doctor"  lay-filter="doctorSel">
                <option value="">请选择医生</option>
                <option value="赵一">赵一</option>
                <option value="钱二">钱二</option>
                <option value="孙三">孙三</option>
            </select>
        </div>

    </div>

    <div class="layui-form-item" lay-filter="timeSel">
        <!-- 设置单选，返回开始时间值 -->
        <label class="layui-form-label">可选时间</label>
        <div class="layui-input-inline">
            <input type="radio" name="time" value="9" title="9:00-10:00"></button></div>
        <div class="layui-input-inline">
            <input type="radio" name="time" value="10" title="10:00-11:00"></button></div>
        <div class="layui-input-inline">
            <input type="radio" name="time" value="11" title="11:00-12:00"></button></div>
        <div class="layui-input-inline">
            <input type="radio" name="time" value="14" title="14:00-15:00"></button></div>
        <div class="layui-input-inline">
            <input type="radio" name="time" value="15" title="15:00-16:00"></button></div>
    </div>

    <br>

    <div class="layui-row">
        <div class="layui-col-xs3 layui-col-md-offset4">
            <blockquote class="layui-elem-quote" >
                <div class="aa" style="font-size: large;color: #8D8D8D;text-align: center">
                    该医生该时段剩余号数：
                </div>
                <br>
                <div class="layui-row">
                    <div class="layui-col-xs3 layui-col-md-offset5">
                        <!-- 返回医生剩余号数，30是假的.. -->
                        <button type="button" class="layui-btn"><i class="layui-icon"> 30 </i></button>
                    </div>
                </div>
            </blockquote>
        </div>
        
        <div class="layui-col-xs3 layui-col-md-offset4">
            <br>
            <button type="submit" class="layui-btn layui-col-md-offset5" lay-submit="" lay-filter="registerSubmit">确认预约</button>
        </div>

    </div>
    <br>

    <script src="../../static/layui/layui.js" charset="utf-8"></script>
    <script>
        layui.use(['form', 'select', 'layer'], function() {
            var form = layui.form,
                select = layui.select,
                layer = layui.layer,
                $ = layui.jquery;

            layer.on('layer(layerSel)', function (obj) {
                var data = obj.data;
                console.log(data.identify) //身份证号
                console.log(data.date)   //挂号日期
                $.ajax({
                    //几个参数需要注意一下
                    type: "POST",//方法类型

                    url: "http://localhost:8082//registration//addregistration",//url
                    xhrFields: {
                        withCredentials: true,
                    },
                    dataType: "json",
                    contentType: "application/json",
                    data: JSON.stringify({
                        "identification": data.identify,
                        "date": data.date
                    })
                });
            });

            //监听下拉选择
            select.on('select(doctorSel)', function (obj) {
                var data = obj.data;
                console.log(data.office)  //挂号科室
                console.log(data.title)  //医生职称
                console.log(data.doctor)  //挂号医生
                $.ajax({
                    type: "POST",//方法类型

                    url: "http://localhost:8082//registration//addregistration",//url
                    xhrFields: {
                        withCredentials: true,
                    },
                    dataType: "json",
                    contentType: "application/json",
                    data: JSON.stringify({
                        "office": data.office,
                        "title": data.title,
                        "doctor": data.doctor
                    })
                });

            });

            //监听单项选择
            form.on('radio(timeSel)', function (obj) {
                var data = obj.data;
                console.log(data.time)  //挂号时间
                $.ajax({
                    //几个参数需要注意一下
                    type: "POST",//方法类型

                    url: "http://localhost:8082//registration//addregistration",//url
                    xhrFields: {
                        withCredentials: true,
                    },
                    dataType: "json",
                    contentType: "application/json",
                    data: JSON.stringify({
                        "identification": data.identify,
                        "office": data.office,
                        "title": data.title,
                        "date": data.date,
                        "doctor": data.doctor,
                        "time": data.time
                    })
                });
            });

            //监听提交
            form.on('submit(registerSubmit)', function (data) {
                layer.alert(JSON.stringify(data.field), {
                    title: '最终的提交信息'
                })
                return false;
            });
        })

    </script>
</form>
</body>
</html>